From 800015d384f4883ebfcf46f68c3ab400ad19bfef Mon Sep 17 00:00:00 2001
From: Antonio Murdaca <runcom@redhat.com>
Date: Thu, 5 Jul 2018 17:06:08 +0200
Subject: [PATCH] Add /proc/acpi to masked paths

The deafult OCI linux spec in oci/defaults{_linux}.go in Docker/Moby
from 1.11 to current upstream master does not block /proc/acpi pathnames
allowing attackers to modify host's hardware like enabling/disabling
bluetooth or turning up/down keyboard brightness. SELinux prevents all
of this if enabled.

Upstream Status: Backport
CVE: CVE-2018-10892

Signed-off-by: Antonio Murdaca <runcom@redhat.com>
Signed-off-by: Ashish <ashishm@mvista.com>
---
 oci/defaults.go | 1 +
 1 file changed, 1 insertion(+)

diff --git a/oci/defaults.go b/oci/defaults.go
index: git/src/import/oci/defaults.go
===================================================================
--- git.orig/src/import/oci/defaults.go
+++ git/src/import/oci/defaults.go
@@ -127,6 +127,7 @@ func DefaultLinuxSpec() specs.Spec {

	s.Linux = &specs.Linux{
		MaskedPaths: []string{
+			"/proc/acpi",
			"/proc/kcore",
			"/proc/latency_stats",
			"/proc/timer_list",
--
2.7.4

